# Suggestion 2.2: Consolidate ANSI Stripping Functions

**Status:** ACCEPTED

**Original Location:** ralph.sh:7 and convert_log.sh:6

**Rationale:** Eliminates code duplication by removing the redundant convert_log.sh file and consolidating the ANSI stripping logic. This ensures consistent behavior and reduces maintenance burden. A simple cleanup with clear benefit.

**Original Content:**

### 2.2 Consolidate ANSI Stripping Functions
**Location:** ralph.sh:7 and convert_log.sh:6

**Issue:** Duplicate ANSI stripping logic in two places.

**Recommendation:**
```bash
# Remove convert_log.sh (it's redundant)
# Source strip_ansi function in ralph.sh only
# Or create a shared utils.sh:
# utils.sh
strip_ansi() { sed 's/\x1b\[[0-9;]*[a-zA-Z]//g'; }
json_escape() { printf '%s' "$1" | sed -e 's/\\/\\\\/g' -e 's/"/\\"/g' -e 's/\t/\\t/g' -e ':a' -e 'N' -e '$!ba' -e 's/\n/\\n/g'; }

# In ralph.sh, source it:
# SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
# source "$SCRIPT_DIR/utils.sh"
```

**Rationale:** Eliminates duplication, ensures consistent behavior, reduces maintenance burden.
